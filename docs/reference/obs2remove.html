<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Finds observations to be removed from ML estimation with fixed-effects — obs2remove • fixest</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Finds observations to be removed from ML estimation with fixed-effects — obs2remove" />
<meta property="og:description" content="For Poisson, Negative Binomial or Logit estimations with fixed-effects, when the dependent variable is only equal to 0 (or 1 for Logit) for one fixed-effect value this leads to a perfect fit for that fixed-effect value by setting its associated fixed-effect coefficient to -Inf. Thus these observations need to be removed before estimation. This function gives the observations to be removed. Note that by default the function femlm or feglm drops them before performing the estimation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fixest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/exporting_tables.html">Exporting estimation tables</a>
    </li>
    <li>
      <a href="../articles/fixest_walkthrough.html">Fast Fixed-Effects Estimation: Short introduction</a>
    </li>
    <li>
      <a href="../articles/multiple_estimations.html">Multiple estimations</a>
    </li>
    <li>
      <a href="../articles/standard_errors.html">On standard-errors</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lrberge/fixest/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Finds observations to be removed from ML estimation with fixed-effects</h1>
    <small class="dont-index">Source: <a href='https://github.com/lrberge/fixest/blob/master/R/Deprecated_funs.R'><code>R/Deprecated_funs.R</code></a></small>
    <div class="hidden name"><code>obs2remove.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For Poisson, Negative Binomial or Logit estimations with fixed-effects, when the dependent variable is only equal to 0 (or 1 for Logit) for one fixed-effect value this leads to a perfect fit for that fixed-effect value by setting its associated fixed-effect coefficient to <code>-Inf</code>. Thus these observations need to be removed before estimation. This function gives the observations to be removed. Note that by default the function <code><a href='femlm.html'>femlm</a></code> or <code><a href='feglm.html'>feglm</a></code> drops them before performing the estimation.</p>
    </div>

    <pre class="usage"><span class='fu'>obs2remove</span><span class='op'>(</span><span class='va'>fml</span>, <span class='va'>data</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"poisson"</span>, <span class='st'>"negbin"</span>, <span class='st'>"logit"</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fml</th>
      <td><p>A formula containing the dependent variable and the fixed-effects. It can be of the type: <code>y ~ fixef_1 + fixef_2</code> or <code>y ~ x1 | fixef_1 + fixef_1</code> (in which case variables before the pipe are ignored).</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame containing the variables in the formula.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Character scalar: either &#8220;poisson&#8221; (default), &#8220;negbin&#8221; or &#8220;logit&#8221;.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>It returns an integer vector of observations to be removed. If no observations are to be removed, an empty integer vector is returned. In both cases, it is of class <code>fixest.obs2remove</code>.
The vector has an attribute <code>fixef</code> which is a list giving the IDs of the fixed-effects that have been removed, for each fixed-effect dimension.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='fixest-deprecated.html'>fixest-deprecated</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>base</span> <span class='op'>=</span> <span class='va'>iris</span>
<span class='co'># v6: Petal.Length with only 0 values for 'setosa'</span>
<span class='va'>base</span><span class='op'>$</span><span class='va'>v6</span> <span class='op'>=</span> <span class='va'>base</span><span class='op'>$</span><span class='va'>Petal.Length</span>
<span class='va'>base</span><span class='op'>$</span><span class='va'>v6</span><span class='op'>[</span><span class='va'>base</span><span class='op'>$</span><span class='va'>Species</span> <span class='op'>==</span> <span class='st'>"setosa"</span><span class='op'>]</span> <span class='op'>=</span> <span class='fl'>0</span>

<span class='op'>(</span><span class='va'>x</span> <span class='op'>=</span> <span class='fu'>obs2remove</span><span class='op'>(</span><span class='va'>v6</span> <span class='op'>~</span> <span class='va'>Species</span>, <span class='va'>base</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: This function is deprecated and will disappear in 1 year from 12/11/2020.</span></div><div class='output co'>#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
#&gt; [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
#&gt; attr(,"class")
#&gt; [1] "fixest.obs2remove"
#&gt; attr(,"family")
#&gt; [1] "poisson"
#&gt; attr(,"fixef")
#&gt; attr(,"fixef")$v6
#&gt; [1] 0
#&gt; 
#&gt; attr(,"fixef")$Species
#&gt; [1] "setosa"
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"fixef"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $v6
#&gt; [1] 0
#&gt; 
#&gt; $Species
#&gt; [1] "setosa"
#&gt; </div><div class='input'>
<span class='co'># The two results are identical:</span>
<span class='va'>res_1</span> <span class='op'>=</span> <span class='fu'><a href='femlm.html'>femlm</a></span><span class='op'>(</span><span class='va'>v6</span> <span class='op'>~</span> <span class='va'>Petal.Width</span> <span class='op'>|</span> <span class='va'>Species</span>, <span class='va'>base</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>NOTE: 1 fixed-effect (50 observations) removed because of only 0 outcomes.</span></div><div class='input'><span class='co'># =&gt; note + obsRemoved is created</span>

<span class='va'>res_2</span> <span class='op'>=</span> <span class='fu'><a href='femlm.html'>femlm</a></span><span class='op'>(</span><span class='va'>v6</span> <span class='op'>~</span> <span class='va'>Petal.Width</span> <span class='op'>|</span> <span class='va'>Species</span>, <span class='va'>base</span><span class='op'>[</span><span class='op'>-</span><span class='va'>x</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='co'># =&gt; no note because observations are removed before</span>

<span class='fu'><a href='etable.html'>esttable</a></span><span class='op'>(</span><span class='va'>res_1</span>, <span class='va'>res_2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                           res_1           res_2
#&gt; Dependent Var.:              v6              v6
#&gt;                                                
#&gt; Petal.Width     0.2089 (0.1324) 0.2089 (0.1324)
#&gt; Fixed-Effects:  --------------- ---------------
#&gt; Species                     Yes             Yes
#&gt; _______________ _______________ _______________
#&gt; S.E.: Clustered     by: Species     by: Species
#&gt; Observations                100             100
#&gt; Squared Cor.            0.69884         0.69884
#&gt; Pseudo R2               0.02726         0.02726
#&gt; BIC                      362.73          362.73</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>res_1</span><span class='op'>$</span><span class='va'>obs_selection</span><span class='op'>$</span><span class='va'>obsRemoved</span> <span class='op'>==</span> <span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laurent Berge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


